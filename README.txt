

Программа по анализу экспериментальных данных 2.0

	
____________________________________________________ПОРЯДОК РАБОТЫ______________________________________________________

1. Настройка обрезки кадра так, чтобы было видно время
2. Выбор ПКМ области кадра со временем, кнопка "Зафиксировать"
3. (При необходимости ещё одна настройка кадра - после выбора области со временем, кадр можно и обрезать обратно)

4. Установка нужной скорости, выбор текущего фиксируемого действия животного кнопкой Start
5. по окончании действия - кнопка Stop / s на клавиатуре или просто пауза, ввод начального и конечного времени, кнопка
	"В отчёт"

Повторить пункты 4,5 до конца обрабатываемого видео

Открыть следующее видео из меню сверху, начать опять с п. 1.

_________________________________________________ЭЛЕМЕНТЫ ИНТЕРФЕЙСА____________________________________________________


Меню (сверху):  - Помощь (вывод данного файла)
				- Открытие нового файла
				- Сохрание общих настроек программы (опции скорости видео и текущий список движений животного)
				- Сохрание настроек обработки видео (фильтры распознавания, движки обрезки кадра)

Настройки (справа):
				- Задержка между обработкой кадров в мс - регулирует скорость прокрутки видео
				- Следующий кадр - регулирует какой кадр берёт программа (каждый первый / каждый десятый)

				- Фильтры
				- Обрезка кадра
				
				Выбор областей (пока реализован выбор области времени - выбран по-умолчанию)
				
				Кнопка зафиксировать - необходимо нажать после выбора соответствующей области
				(для смены выбора аналогично - выбрать новую область, нажать кнопку зафиксировать)				

Область видео 

	   - Правой кнопкой - выделение областей в кадре
	   - Левой кнопкой - установка положения крысы
	   (пока лишь включает режим, а маркер устанавливается автоматически по распознанному положению)
	   
Текущий кадр - движок текущего положения видео. Может быть перемотан вручную в режиме паузы

Stop - кнопка прекращения фиксации текущего движения - ставит видео на паузу, ставит курсор на ввод времени

Новое действие - добавление возможности ввода/выбора нового действия животного

Start - кнопка начала фиксации действия животного указанного справа от кнопки типа

Ввода времени и кнопка записи в отчёт: - активируется после выбора и фиксации области времени в кадре
									   - запись в отчёт доступна после выбора соответствующего действия или
									   ввода времени в корректном формате (ЧАСЫ МИНУТЫ СЕКУНДЫ - вместо пробела
									   можно также использовать : или , в качестве разделителя)		
									   - Кнопка "В отчёт" делает запись в новом (если ранее не был создан) или в уже
									   созданном файле с расширением .csv (Для последующей обработки в Excel)
									   

______________________________________________________УПРАВЛЕНИЕ________________________________________________________

- ESC - выход

- Снять фокус с текстового поля - нажатие правой кнопкой мыши по любой пустой области окна программы

- Пробел - пауза / продолжение проигрывания видео (в начале работы программы пауза
(Когда активен ввод в текстовое поле, пробел вводит пробел туда, на паузу не влияет)

- При зафиксированной области времени:
1-9 - выбор с клавиатуры 1-9 действия соответственно (нажатиe кнопки старт)

- При выбранном действии:
s - нажатие кнопки stop

- При вводе времени - Enter - переход на второе поле ввода / кнопка "В отчёт"

В режиме паузы:
- Стрелка вправо - перемотка вправо (со скоростью движка FrameDelta)
- Стрелка вправо - перемотка влево (со скоростью движка FrameDelta)

____________________________________________________ФАЙЛЫ И ПАПКИ_______________________________________________________

Файлы в рабочей директории с программой:
	
	options.txt - опции обработки видео, загружаемые по-умолчанию
	general_options - общие опции программы и текущий список описанных движений животного
	

Автосоздаваемые папки при работе с видео (в каждой папке с видео):

	options - файлы c сохранёнными настройками под конкретные файлы
	results - файлы с сохранёнными отчётами по фиксации активности
	
	tracks - записи треков и графиков (пока неактивно)
	
__________________________________________________ФОРМАТ ФАЙЛА ОПЦИЙ____________________________________________________

	Все строчки, начинающиеся с #  - комментарии
	В качестве разделителей допустимы пустые строки или комметарии
	Любые другие строки определяются программой как опции в формате: [категория] <ключ> <значение> [имя движка в программе]
	Значения с пробелом не допускаются (в качестве значения будет определяться лишь первое слово до пробела)
	Порядок опций не важен, но ЗНАЧЕНИЯ КЛЮЧЕЙ ВРУЧНУЮ МЕНЯТЬ НЕЛЬЗЯ для сохранения работоспособности программы
	Опции не должны повторяться
	
options.txt описание опций:

Неиспользуемые в качестве движков опции:
-------------------------------------------------------------------------
exclude ... строка значений

Категория: size (Значения для настройки обрезки кадра и скорости смены кадров):
-------------------------------------------------------------------------

сдвиг рамки кадра по X (+ максимальный сдвиг)
size x0 16
size x0_Max 120

ширина рамки кадра по X (< 320 по-умолчанию - размер видео)
size width 300
size width_Max 320 (по-умолчанию) - размер видео

сдвиг рамки кадра по Y (+ максимальный сдвиг)
size y0 30
size y0_Max 120

высота рамки кадра по Y (< 240 по-умолчанию - размер видео)
size height 200
size height_Max 240 (по-умолчанию) - размер видео

Без категории (пока в exclude):
-------------------------------------------------------------------------
FPS (Не настраивается в программе, выставляется только тут! FPS текущих экспериментальных видео 10-11)
FPS 10

Интервал времени для расчёта скорости в секундах (Не настраивается в программе, выставляется только тут!)
SpeedDelta 10

максимальный "скачок" точки отмечающей положение крысы за 1 кадр
по-другому - максимально возможное перемещение крысы за 1 кадр. Всё, что больше - считается погрешностью
maxjump 100

Цвета: 
цвет круга, отмечающего положение крысы (сокращения от red Trace и т.д.)
rT 0
gT 0
bT 255

цвет обработанного трека (сокращения от red Last и т.д.)
rL 255
gL 255
bL 255


Категория filter (значения цветофильтров для распознавания):
-------------------------------------------------------------------------
Hue - цветовой фон (OpenCV 0-179)
filter h1 0
filter h2 12

Saturation - насыщенность (OpenCV 0-255)
filter s1 30
filter s2 57

Value/Brightness - яркость (OpenCV 0-255)
filter v1 158
filter v2 190

general_options.txt описание опций:

Категория process: 

Задержка между сдвигами кадра в миллисекундах (>0!) (+максимальная)
process delay 100
process delay_Max 1000

Ускорение (на сколько кадров видео сдвиг за цикл)
process FrameDelta 1
process FrameDelta_Max 10

Категория action (Известные движения крысы):
# 
action Сидит, шебуршится
...

last_video - последняя открытая папка с видео - если не были изменены/сохранены общие настройки программы, дописывается
в конец - может быть использована в качестве журнала

